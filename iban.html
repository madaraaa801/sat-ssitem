<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IBAN ile Ödeme</title>
  <style>
    body {
      background: #111;
      color: white;
      font-family: sans-serif;
      padding: 20px;
      text-align: center;
    }
    .box {
      background: #222;
      border-radius: 12px;
      padding: 30px;
      max-width: 400px;
      margin: 40px auto;
    }
    h2 {
      color: #00ff88;
    }
    p {
      margin: 10px 0;
    }
    input, button {
      margin-top: 10px;
      padding: 10px;
      border-radius: 6px;
      border: none;
      width: 100%;
    }
    button {
      background: #00ff88;
      color: #000;
      font-weight: bold;
      cursor: pointer;
    }
    input[type="file"] {
      background: #fff;
      color: #000;
    }
    input[type="text"] {
      background: #333;
      color: white;
    }
    .download-link {
      margin-top: 20px;
      background: #00ff88;
      color: black;
      padding: 10px;
      border-radius: 8px;
      text-decoration: none;
      display: inline-block;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <div class="box">
    <h2 id="urun-adi">Ürün</h2>
    <p id="fiyat">Fiyat: ...</p>
    <p><strong>IBAN:</strong><br>BURDA İBAN YAZACAK ŞİMDİLİK KAPALI TİCKET ÜZERİNDEN DEVAM</p>
    <p>IBAN'a ürünün ücretini gönderin ve dekont yükleyin.</p>

    <form action="yukle.php" method="POST" enctype="multipart/form-data" id="paymentForm">
      <input type="hidden" name="urun_id" id="urun_id" value="">
      <input type="hidden" name="token" id="token" value="">
      
      <input type="file" name="dekont" required><br>
      <input type="text" name="discord" placeholder="Discord Adınız" required><br>
      <button type="submit">Gönder</button>
    </form>

    <div id="downloadArea"></div>
  </div>

  <script>
    const urunler = {
      1: { ad: "İngiliz Asker Map", fiyat: "333 TL" },
      2: { ad: "BOT Site V1", fiyat: "50 TL" },
      3: { ad: "BOT Website V2", fiyat: "45 TL" },
      4: { ad: "Link Site V1/V2/V3", fiyat: "25 TL" },
      5: { ad: "Kişisel Web Site", fiyat: "35 TL" }
    };

    const params = new URLSearchParams(window.location.search);
    const urunID = params.get("urun");
    const token = params.get("token") || "";
    const discordUser = params.get("discord") || "";

    if (urunler[urunID]) {
      document.getElementById("urun-adi").innerText = urunler[urunID].ad;
      document.getElementById("fiyat").innerText = "Fiyat: " + urunler[urunID].fiyat;
      document.getElementById("urun_id").value = urunID;
      if (token) document.getElementById("token").value = token;
    } else {
      document.querySelector(".box").innerHTML = "<p>Geçersiz ürün ID!</p>";
    }

    document.getElementById("paymentForm").addEventListener("submit", function(e) {
      e.preventDefault();

      if(token && urunID) {
        const downloadArea = document.getElementById("downloadArea");
        const encodedDiscord = encodeURIComponent(discordUser || "Müşteri");

        // Burada buton ile aynı sekmede yönlendirme yapıyoruz
        downloadArea.innerHTML = `
          <button class="download-link" id="goDownload">İndirme Sayfasına Git</button>
        `;

        document.getElementById("goDownload").onclick = () => {
          window.location.href = \`download.html?urun=\${urunID}&token=\${token}&user=\${encodedDiscord}\`;
        };

      } else {
        alert("Lütfen geçerli token ve ürün bilgisi olduğundan emin olun.");
      }
    });
  </script>

</body>
</html>
